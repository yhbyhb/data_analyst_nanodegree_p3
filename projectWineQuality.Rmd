Wine Quality Reds Exploration by HanByul Yang
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
knitr::opts_chunk$set(comment = NA, echo=FALSE, message = FALSE, 
                      warnings = FALSE, cache=TRUE, cache.path='cache/',
                      fig.path='figure/')
# Loading required libraries
library(ggplot2)
library(GGally)
library(scales)
library(memisc)
library(knitr)
library(dplyr)
library(gridExtra)
library(psych)
theme_set(theme_minimal(20))
```

```{r load_the_data}
# Load the data
df <- read.csv('wineQualityReds.csv')

# Remove unnecessary column "X" which indicates index.
drops <- c("X")
wineQuality <- df[, !(names(df) %in% drops)]
```

# Summary of the data set
```{r summary_of_data_set}
# Summarize the data set
dim(wineQuality)
names(wineQuality)
str(wineQuality)
summary(wineQuality)
```

1. Data set consists of 1599 red wine and have 11 input attributes and 1 output attributes.
1. The quality is varies from 3 to 8 with median 6.
1. The alcohol is varies from 8.4% to 14.9%.
1. The median qulity of red wine is 6. median residual.sugar is 2.2 g / dm^3.
median alcohol of red wine is 10.2 %.

# Univariate Plots Section

```{r fixed.acidity}
qplot(fixed.acidity, data = wineQuality)
# qplot(fixed.acidity, data = wineQuality, binwidth=0.2)
```

Most red wines have fixed acidity between 7.10 g/dm^3 and  9.20 g/dm^3.

```{r volatile.acidity}
# qplot(volatile.acidity, data = wineQuality)
qplot(volatile.acidity, data = wineQuality, binwidth = 0.025) +
  coord_cartesian(xlim=c(0, 1.4))
```

Most red wines have volatile acidity between 039 g/dm^3 and 0.64 g/dm^3. There are some outliers above 1.5

```{r citric.acid}
qplot(citric.acid, data = wineQuality)
```

The citric acid has three peaks around 0, 0.25 and 0.5g/dm^3.

```{r citric.acid_statistics}
table(wineQuality$citric.acid == 0)
summary(wineQuality$citric.acid)
sort(table(wineQuality$citric.acid), decreasing = T)
```

About 9% red wines have no citric acid. There is an outlier that has 1.0 g/dm^3.

```{r citric.acid_remove_outliers}
qplot(citric.acid, data = wineQuality, binwidth = 0.03) +
  coord_cartesian(xlim=c(0, 0.8))
```

Adjust x-axis by removing outliers and bin width for better visualization.

```{r residual.sugar}
qplot(residual.sugar, data = wineQuality)
# qplot(residual.sugar, data = wineQuality, binwidth = 0.1) + 
#   coord_cartesian(xlim=c(0, 16))
summary(wineQuality$residual.sugar)
```

The histotram of residual sugar has one peak and long-tailed.
Most of red wines have residual sugar between 1.9 g/dm^3 to 2.6 g/dm^3: median 2.2g/dm^3 and mean 2.539 g/dm^3.

```{r residual.sugar_log10}
qplot(residual.sugar, data = wineQuality) + 
  scale_x_log10()
```

Transformed x-axis with log10() for better visualization.

```{r chlorides}
qplot(chlorides, data = wineQuality)
# qplot(chlorides, data = wineQuality, binwidth = 0.005) + 
#   coord_cartesian(xlim=c(0, 0.25))
```

chlorides seems to have some outliers.

```{r chlorides_statistics}
sort(table(wineQuality$chlorides), decreasing = T)
summary(wineQuality$chlorides)
```

Most of red wines have chlorides between 0.07 g/dm^3 to 0.09 g/dm^3: median 0.079 g/dm^3 and mean 0.08747 g/dm^3. 

```{r chlorides_remove_outliers}
qplot(chlorides, data = wineQuality, binwidth = 0.005) +
  coord_cartesian(xlim=c(0, 0.3))
  # scale_x_log10(breaks = c(0.01, 0.025, 0.05, 0.1, 0.2, 0.5))
```

Removed outliers above 0.3 g/dm^3 and adjusted bin width for better looking.

```{r free.sulfur.dioxide}
qplot(free.sulfur.dioxide, data = wineQuality)
```

There seems to be some outliers on histogram of free.sulfur.dioxide

```{r free.sulfur.dioxide_statistics}
sort(table(wineQuality$free.sulfur.dioxide), decreasing = T)
summary(wineQuality$free.sulfur.dioxide)
```

Most free.sulfur.dioxide values are integers except 2 of them and Most of them are between 7 mg/dm^3 and 21 mg/dm^3.

```{r free.sulfur.dioxide_remove_outliers}
qplot(free.sulfur.dioxide, data = wineQuality) +
  coord_cartesian(xlim=c(0, 60))
```

Removed outliers above 60 mg/dm^3.

```{r total.sulfur.dioxide}
qplot(total.sulfur.dioxide, data = wineQuality)
```

There are 2 outliers above 170 mg/dm^3.

```{r total.sulfur.dioxide_statistics}
sort(table(wineQuality$total.sulfur.dioxide), decreasing = T)
summary(wineQuality$total.sulfur.dioxide)
```

All of total.sulfur.dioxide values are integers.
Most red wines have a total.sulfur.dioxide between 22 mg/dm^3 and 62 mg/dm^3. median is 38 mg/dm^3. 

```{r total.sulfur.dioxide_remove_outliers}
qplot(total.sulfur.dioxide, data = wineQuality) + 
  coord_cartesian(xlim=c(0, 170))
```

I removed outliers for better visualization.

```{r density, warning=FALSE}
qplot(density, data = wineQuality)
summary(wineQuality$density)
```

The density value seems to display a normal distribution with major values between 0.995 and 1.0.

```{r pH}
qplot(pH, data = wineQuality)
summary(wineQuality$pH)
# sort(table(wineQuality$pH), decreasing = T)
```

The pH also seems to have a normal distribution.
Most of red wines have a pH between 3.21 and 3.4: median 3.31 and mean 3.311.

```{r sulphates}
qplot(sulphates, data = wineQuality)
```

The sulphates has outliers above 1.5 g/dm^3 and has peak around 0.6.

```{r sulphates_statistics}
# sort(table(wineQuality$sulphates), decreasing = T)
table(wineQuality$sulphates)
summary(wineQuality$sulphates)
```

Median of sulphates is 0.62 g/dm^3.

```{r sulphates_remove_outliers}
qplot(sulphates, data = wineQuality) +
  coord_cartesian(xlim=c(0.3, 1.4))
```

Ignored above 1.4 g/dm^3 as outliers for better visualization.

```{r alcohol}
qplot(alcohol, data = wineQuality)
# qplot(alcohol, data = wineQuality, binwidth = 0.1)
summary(wineQuality$alcohol)
```

The alcohol varies between 8 to 14 with major peaks around 10.
Most of red wines have a alcohol between 9.5 and 11.1: median 10.2 and mean 10.42.

```{r quality}
qplot(x = quality, data = wineQuality) +
  scale_x_discrete() +
  coord_cartesian(xlim=c(2.5, 8.5))
summary(wineQuality$quality)
sort(table(wineQuality$quality), decreasing = T)
```

All of quality values are integers and between 3 and 8.
Most of red wines have a quality between 5 and 6: median 6 and mean 5.636

```{r make_quality_class_variable}
attach(wineQuality)
wineQuality$quality_class[quality <= 3] <- 1
wineQuality$quality_class[quality >= 4 & quality <= 6] <- 2
wineQuality$quality_class[quality >= 7] <- 3
detach(wineQuality)

wineQuality$quality_class <- factor(wineQuality$quality_class, labels = c("low", "medium", "high"))
```

```{r quality_class} 
qplot(quality_class, data = wineQuality, geom="bar")
summary(wineQuality$quality_class)
```

I created "quality_class" for simple categorical analysis. It has three level of quality.
 
1. low (quality <= 3 or 0, 1, 2, 3)
1. medium (4 <= quality <= 6 or 4, 5, 6)
1. hight (7 <= quality or 7, 8, 9, 10)

85.8% (1372 / 1599) are medium quality

# Univariate Analysis

### What is the structure of your dataset?
There are 1599 red wines and have 13 variables(11 input features and 2 output features. (quality and quailti_class). There are 12 variables from the csv files. I added 1 varaible for the analysis.

### What is/are the main feature(s) of interest in your dataset?
The main features in the data set is quality. I'd like to find which chemical properties influence the quality of red wine. I suspect alcohol is highly related with quality, since red wine is a kind of liquor.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
I think flavor or taste may highly related with quality. So acid related varaiables such as pH or citric.acid and residual.sugar will help the investigation.

### Did you create any new variables from existing variables in the dataset?
All of given variables have numerial values. It makes difficult on bi or multivariate analysis. So, I created "quality_class" variable for bivariate or multivariate analysis of "quality" feature. 

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?
The citric acid has three peaks around 0, 0.25 and 0.5g/dm^3.
132 red wines (about 9%) have no citric.acid.

'quality' variable is just numerical value. So, I converted it to 6 levels factored variable named 'quality_class' for better visualization of histogram and further categorical analysis.

# Bivariate Plots Section
```{r Correlation_matrix}
#Generate correlation matrix except 'quality_class' which is duplicated with 
#'quality'. Use from Column 1 to Column 12.
cor(wineQuality[, c(1:12)])
```

The alcohol and sulphates are the most correlated features with quality. The volatile.acidity is the best negatively correlated with quality.

```{r Pairs_Panel,  fig.width=10, fig.height=7.5}
pairs.panels(wineQuality[, c(1:12)])
```

First, I will look into scatterplots involving quality and highly correlated variables, such as alcohol, sulphates, volatile.acidity.

### alcohol and quality

```{r alcohol_and_quality}
ggplot(aes(x = quality, y = alcohol), data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2) + 
  scale_x_discrete() +
  coord_cartesian(xlim=c(2.5, 8.5))
```

Since the scatterplot is overplotted, I used jitter and alpha for a better visual.

```{r alchol_and_quality_boxplot}
ggplot(aes(x = factor(quality), y = alcohol), data = wineQuality) +
  geom_boxplot()
```

I used factored variable 'quality' for boxplot. The boxplot shows that medians alcohol value of each quality have positive slope.

```{r alchol_and_quality_density}
qplot(alcohol, data = wineQuality,
      color = factor(quality), geom = 'density')
```

With density function, we can see the positive correlation between alcohol and quality.

```{r alcohol_and_quality_linear_model}
# Remove outlier exceed 0.999
wineSubset = subset(wineQuality,
                    alcohol <= quantile(wineQuality$alcohol, 0.999))
qplot(x = alcohol, y = quality, data = wineSubset,
      color = I('black'), alpha = I(1/10)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

# linear model
alcoholQualityLM <- lm(quality ~ alcohol, data = wineSubset)
summary(alcoholQualityLM)
```

The linear model of alcohol and quality has R-squred value 0.2314. 'wineSubset' is the subset of original data set without outlier of alcohol above 99.9%.

### sulphates and quality
```{r sulphates_and_quality}
ggplot(aes(x = quality, y = sulphates), data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2)

# Remove outlier exceed 0.99
wine_sulphates_Subset = subset(wineQuality,
                    sulphates <= quantile(wineQuality$sulphates, 0.99))
qplot(x = sulphates, y = quality, data = wine_sulphates_Subset,
      color = I('black'), alpha = I(1/10)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

sulphatesQualityLM <- lm(quality ~ sulphates, data = wine_sulphates_Subset)
summary(sulphatesQualityLM)
```

'sulphates' is second positively correlated with quality. After removing outlier above 99%, The linear model has R-squred value 0.1041.

### voltile.acidity and quality
```{r volatile.acidity_and_quality}
ggplot(aes(x = quality, y = volatile.acidity), data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2)

# linear model. Remove outlier exceed 0.999
wine_v_acidity_Subset = subset(wineQuality,
                               volatile.acidity <=
                                 quantile(wineQuality$volatile.acidity, 0.999))
qplot(x = volatile.acidity, y = quality, data = wine_v_acidity_Subset,
      color = I('black'), alpha = I(1/10)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

volatile.acidityQualityLM <- lm(quality ~ volatile.acidity,
                                data = wine_v_acidity_Subset)
summary(volatile.acidityQualityLM)
```

'volatile.acidity ' is most negatively correlated with quality. The linear model has R-squred value 0.1474 without outlier abvoe 99.9%.

## Flavor and quality
I'll investigate flavor related variables and quality. 

 1. residual.sugar for sweetness
 1. chlorides for salty
 1. citric.acid for fressness

### residual.sugar and quality
```{r residual.sugar_and_quality}
ggplot(aes(x = quality, y = residual.sugar), data = wineQuality) +
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 6))

# linear model. Remove outlier exceed 0.99
wine_r.sugar_subset = subset(wineQuality,
                             residual.sugar <=
                               quantile(wineQuality$residual.sugar, 0.99))
qplot(x = residual.sugar, y = quality, data = wine_r.sugar_subset,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

residual.sugarQualityLM <- lm(quality ~ residual.sugar,
                              data = wine_r.sugar_subset)
summary(residual.sugarQualityLM)
```

It seems to no relationship between residual.sugar and quality. Sweet flavor does not affect on deciding quality.

### chlorides and quality
```{r chlorides_and_quality}
ggplot(aes(x = quality, y = chlorides), data = wineQuality) +
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 0.3))

# linear model. Remove outlier exceed 0.99
wine_chlorides_subset = subset(wineQuality,
                             chlorides <=
                               quantile(wineQuality$chlorides, 0.99))
qplot(x = chlorides, y = quality, data = wine_chlorides_subset,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

chloridesQualityLM <- lm(quality ~ chlorides, data = wine_chlorides_subset)
summary(chloridesQualityLM)
```

'chlorides' show the amount of salt in wine. salty flavor also merely related with quality. Linear model of chlorides and quality has R-squared value is 0.01437.

### citric.acid and quality
```{r citric.acid_and_quality}
ggplot(aes(x = quality, y = citric.acid), data = wineQuality) +
  geom_boxplot()

# linear model. Remove outlier exceed 0.999
wine_c.acid_subset = subset(wineQuality,
                            citric.acid <=
                              quantile(wineQuality$citric.acid, 0.999))
qplot(x = citric.acid, y = quality, data = wine_c.acid_subset,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

citric.acidQualityLM <- lm(quality ~ citric.acid, data = wine_c.acid_subset)
summary(citric.acidQualityLM)
```

R-squred value of linear model between citric.acid and quality is 0.055 but it is much bigger than chlorides and residual.sugar.

## similar variables investigation
It is not related with finding variables for deciding quality. 
There are some variables related each other. such as sulfur dioxide family and acidity family. 

### free.sulfur.dioxide and total.sulfur.dioxide
```{r free.sulfur.dioxide_and_total.sulfur.dioxide}
# ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), data = wineQuality) +
#   geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2)

qplot(x = free.sulfur.dioxide, y = total.sulfur.dioxide, data = wineQuality,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

sulfur.dioxideyQualityLM <- lm(total.sulfur.dioxide ~ free.sulfur.dioxide,
                               data = wineQuality)
summary(sulfur.dioxideyQualityLM)
```

total.sulfur.dioxide seems to be relatively high correlated with free.sulfur.dioxide.  R-squraed value is 0.4458 for its linear model.

### volatile.acidity and pH
```{r volatile.acidity_and_pH}
# ggplot(aes(x = volatile.acidity, y = pH), data = wineQuality) +
#   geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2)

# wine_v_acidity_Subset <- Remove outlier exceed 0.999
qplot(x = volatile.acidity, y = pH, data = wine_v_acidity_Subset,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

v.acidity_pH_LM <- lm(pH ~ volatile.acidity, data = wine_v_acidity_Subset)
summary(v.acidity_pH_LM)
```

R-squared value is relavely low 0.05432. pH does not affected by volatile.acidity.

### fixed.acidity and pH
```{r fixed.acidity_and_pH}
# ggplot(aes(x = fixed.acidity, y = pH), data = wineQuality) +
#   geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2)

# wine_f.acid_subset <- Remove outlier exceed 0.999
wine_f.acid_subset = subset(wineQuality,
                            fixed.acidity <= 
                              quantile(wineQuality$fixed.acidity, 0.999))
qplot(x = fixed.acidity, y = pH, data = wine_f.acid_subset,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

f.acidity_pH_LM <- lm(pH ~ fixed.acidity, data = wine_f.acid_subset)
summary(f.acidity_pH_LM)
```

Based on R-squared balue, fixed.acidity can explain about 46.5% of the variance in pH. 
As the median value of fixed.acidity 7.9 g/dm^3 and volatile.acidity 0.52 g/dm^3, fixed.acidity mainly affects pH.

### citric.acid and pH
```{r citric.acid_and_pH}
# ggplot(aes(x = citric.acid, y = pH), data = wineQuality) +
#   geom_jitter(colour = 'black', fill = 'black',  alpha = 1/5, pch=21, cex=2)

qplot(x = citric.acid, y = pH, data = wineQuality,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

citric.acid_pH_LM <- lm(pH ~ citric.acid, data = wineQuality)
summary(citric.acid_pH_LM)
```

R-squared value is 0.2937 and it is bigger than volatile.acidity linear model. Median value of citric.acid is 0.26g/dm^3 and smaller than volatile.acidity(0.52g/dm^3)

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

Based on correlation value, I investigated relationship between quality and other variables. Alcohol is the most influential chemical of red wine.

At the view of flavors, there seems to be no highly related variables to quality. Especially, salty(chloride) and sweet(residual.sugar) taste have almost no influence with quality of wine.

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

I observed chemically similar variables. As expected, free.sulfur.dioxide and total.sulfur.dioxide is highly related. ("Total"" includes "free"")

Relationship between acid variables and pH is also interesting. As expected, higher acidity shows low pH except volatile.acidity. linear model between volatile.acidity and pH has low R-squared value 0.05432. 
Fixed acidity is most dominent fluence on pH and its R-square value is 0.4654, as we expected on median values of acid variables.

### What was the strongest relationship you found?

Relationship between fixed.acidity and pH is most highly related. Its correlation value is 0.68 and R-squared value of linear model is 0.4654.


# Multivariate Plots Section
First, I'd like to investigate base on correlation.

### alcohol, volatile.acidity and quality
```{r alcohol_volatile.acidity_and_quality}
ggplot(aes(x = alcohol, y = volatile.acidity), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/5, pch=21, cex=2)
```

It shows weak relationship between alcohol and volatile.acidity. However It is hard to find distributions by quality. So I used facet_wrap().

```{r alcohol_volatile.acidity_and_quality_facet_warp}
ggplot(aes(x = alcohol, y = volatile.acidity), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

It is easily found that lowest(3) and highest(8) quality are distributed differently on the scatterplot.

```{r alcohol_volatile.acidity_and_quality_LM}
qplot(x = volatile.acidity/alcohol, y = quality, data = wineQuality,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

vPeraLM <- lm(quality ~ volatile.acidity/alcohol, data = wineQuality)
summary(vPeraLM)
```

volatile.acidity / alcohol is negatively correlated with quality. Its linear model has 0.2954 R-squared value.

### alcohol, sulphates and quality
```{r alcohol_sulphates_and_quality}
ggplot(aes(x = alcohol, y = sulphates), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/5, pch=21, cex=2)

ggplot(aes(x = alcohol, y = sulphates), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

```{r alcohol_sulphates_and_quality_LM}
qplot(x = sulphates/alcohol, y = quality, data = wineQuality,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

sPeraLM <- lm(quality ~ sulphates/alcohol, data = wineQuality)
summary(sPeraLM)
```

Ratio of sulphates and alcohol is alsho negatively related with quality with R-squared value 0.2866.

### volatile.acidity, sulphates and quality
```{r volatile.acidity_sulphates_and_quality}
ggplot(aes(x = volatile.acidity, y = sulphates), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/5, pch=21, cex=2)

ggplot(aes(x = volatile.acidity, y = sulphates), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

```{r volatile.acidity_sulphates_and_quality_LM}
qplot(x = sulphates/volatile.acidity, y = quality, data = wineQuality,
      color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue')

sPervLM <- lm(quality ~ sulphates/volatile.acidity, data = wineQuality)
summary(sPervLM)
```

sulphates / volatile.acidity is relatively postive related with quality. Its linear model has 0.1743 R-squared value.

## similar variables investigation
I'd like to continue from bivariate plots by adding quality variable. 
First, sulfur dioxide famliy (free.sulfur.dioxide and total.sulur.dioxide)

### sulfur dioxide famliy
```{r sulfur_dioxide_famliy}
ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/4, pch=21, cex=2)

ggplot(aes(x = free.sulfur.dioxide, y = total.sulfur.dioxide), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

Sulfur dioxide family positively correlated. There is no sigficant difference of each quality distribution.

### acidity famliy
"pH" is related with acidity. I'll check relationship between pH and acid related variables: volatile.acidity, fixed.acidity and citric.acid

```{r, acid_family_volatile.acidity}
ggplot(aes(x = pH, y = volatile.acidity), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/4, pch=21, cex=2)

ggplot(aes(x = pH, y = volatile.acidity), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

```{r, acid_family_fixed.acidity}
ggplot(aes(x = pH, y = fixed.acidity), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/4, pch=21, cex=2)

ggplot(aes(x = pH, y = fixed.acidity), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

```{r, acid_family_citric.acid}
ggplot(aes(x = pH, y = citric.acid), 
       data = wineQuality) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/4, pch=21, cex=2)

ggplot(aes(x = pH, y = citric.acid), 
       data = wineQuality) +
  geom_jitter(colour = 'black', fill = 'black',  alpha = 1/4, pch=21, cex=2) +
  facet_wrap(~quality)
```

pH is posively correlated with volatile.acidity with low correlation value but negatively correlated with fixed.acidity and citric.acid. There is no noticeable among quality class.

### multivariate linear model
```{r Build_Linear_Model}
# Remove outliers
wineSubset = subset(wineQuality,
                    alcohol <= quantile(wineQuality$alcohol, 0.999))
# Build linear model for wine quality.
m1 <- lm(quality ~ alcohol,
                    data = wineSubset)
m2 <- update(m1, ~ . + volatile.acidity)
m3 <- update(m2, ~ . + sulphates)
mtable(m1, m2, m3)
```

With three hightest correlated variables (alcohol, volatile.acidity and sulphates), I build linear model for quality. Its R-squared value is 0.341. 

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

Relationship between quality and alcohol is strenthed by add another variables highly correlated with qulaity. 

In case of quality and volatile.acidity / alcohol.
The R-squared value : 0.2954

Linear model of Quality and sulphates / alcohol.
The R-squared value : 0.2866

Both are higher than the R-squared value (0.2314) of linear model of quality and alcohol.

### Were there any interesting or surprising interactions between features?
Relationship volatile.acidity and alcohol shows interesting result with using categrical quality_calss variable. The lowest(3) and highest(8) quality are distributed differently on the scatterplot.

Relationship among sulphates, alcohol and quality is observed interesting in same manner. The lowest(3) and highest(8) quality are distributed distantly.

------

# Final Plots and Summary

### Plot One
```{r Plot_One}
# linear model for alcohol and quality. Remove outlier exceed 0.999
wineSubset = subset(wineQuality,
                    alcohol <= quantile(wineQuality$alcohol, 0.999))

ggplot(aes(x = alcohol, y = quality), data = wineSubset) +
  geom_point(color = I('black'), alpha = I(1/5)) +
  geom_smooth(method = 'lm', se = T, color = 'blue') +
  theme(plot.title = element_text(size = 16),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16, angle = 90)) +
  labs(title='Relationship between quality and alcohol',
       x='alcohol (%)', y='quality')
```

### Description One
The highest correlated value with quality is alcohol. The linear model of quality and alcohol has R^2 value 0.2314. To improve R squared value, I added volatile.acidity and sulphates. The linear model of quality with three variable has 0.341 R squared value.

### Plot Two
```{r Plot_Two, fig.width=8, fig.height=7}
theme_set(theme_minimal(12))
# Displaying 3 plots at once.
p1 <- ggplot(aes(x = factor(quality), y = residual.sugar), data = wineQuality)  +
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 5)) +
  ggtitle('residual.sugar by quality') +
  xlab('quality') +
  ylab('residual.sugar (g/dm^3)')

p2 <- ggplot(aes(x = factor(quality), y = chlorides), data = wineQuality)  +
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 0.25)) +
  ggtitle('chlorides by quality') +
  xlab('quality') +
  ylab('chlorides (g/dm^3)')

p3 <- ggplot(aes(x = factor(quality), y = citric.acid), data = wineQuality) +
  geom_boxplot() +
  ggtitle('citric.acid by quality') +
  xlab('quality') +
  ylab('citric.acid (g / dm^3)')

grid.arrange(p1, p2, p3, ncol = 2)
```

### Description Two
There are three flavors in red wine, such as sweetness, salty and freshness. Base on each R-squared value, freshness(citric.acid) is most important flavor for quality decision. Sweetness is not related with quality of red wine. Important flavor order and R-squared values are followed below.

 1. citric.acid (R-squared value 0.055)
 1. chlorides (R-squared value 0.01437)
 1. residual.sugar (R-squared value 0.0002335)
 

### Plot Three
```{r Plot_Three, fig.width=8, fig.height=7}
lowestWineQ <- filter(wineQuality, quality==3)
HighestWineQ <- filter(wineQuality, quality==8)
filterWineQ <-filter(wineQuality, quality==3 | quality==8)

# Legend for quality is displayed with descending order.
p3_1 <- ggplot(aes(x = alcohol, y = volatile.acidity), data = filterWineQ) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/2, pch=21, cex=3) +
  guides(color = guide_legend(reverse = T, title = 'quality'), 
         bg = guide_legend(reverse = T, title = 'quality')) + 
  theme(plot.title = element_text(size = 13),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12, angle = 90)) +
  labs(title='Relationship between alcohol and volatile.acidity by quality',
       x='alcohol (%)', y='volatile.acidity (g / cm^3)')

p3_2 <- ggplot(aes(x = alcohol, y = sulphates), data = filterWineQ) +
  geom_jitter(aes(color=factor(quality), bg=factor(quality)), 
              alpha = 1/2, pch=21, cex=3) +
  guides(color = guide_legend(reverse = T, title = 'quality'), 
         bg = guide_legend(reverse = T, title = 'quality')) + 
  theme(plot.title = element_text(size = 13),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12, angle = 90)) +
  labs(title='Relationship between alcohol and sulphates by quality',
       x='alcohol (%)', y='sulphates (g / cm^3)')  

grid.arrange(p3_1, p3_2)
```

### Description Three
Using relationship volatile.acidity and sulphates with alcohol, It is shown that highest and lowest quality of red wine have noticeably diffrent distribution. 

Low ratio of volatile.acidity and alcohol indicates high quality red wine and high ratio  of sulphates and alcohol indicates high quality red wine.

------

# Reflection
The data set contains 1599 red variants of the Portuguese "Vinho Verde" wine. I started by understanding the individual variables in the data set, and I was interested in "alcohol" feature because wine is a kind of liquor. 

Since dataset is tidy, I don't need to clean of filter it. However, all variables are numerical variables and It is hard to make bi or multi-variate plots. So I made a categorical variable 'quality_class'. Even though, I used categorical variable, It is hard to recogize difference of distribution by quality in one plot. I made each plot for categorical quality variable or filtered some interesting qualities.

I presumed sweetness is highly related with quality of red wine. But surprisingly, the highest important flavor of red wine is freshness by citric acid while sweetness is the lowest import flavor.

As I expected, the most correlated feature of quality is "alcohol" and there are another features that has relation with quality. "volatile.acidity" is also correlated with quality and "sulphates" is negatively correlated. The linear model with only "alcohol" variable has 0.231 R-sqaured value. By adding "volatile.acidity" and "sulphates", R-squared value is increased with 0.341. 

Since the data set consists of samples from the specific red wine mentioned above, there is a limitation of this analysis. It might be interesting to obtain data set from various regions to eliminate any bias created by various products.